<!DOCTYPE html>
<html>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	
	<link
		href="https://fonts.googleapis.com/css?family=Raleway"
		rel="stylesheet"
	/>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.2/dist/FileSaver.min.js"></script>
	<link rel="stylesheet" href="/styles/styles.css" />
	<style></style>
	<body>
		<form id="regForm" >
			<h1>Let&apos; generate your resume:</h1>

			<div class="tab">
				Personal Information
				<p>
					<input
						type="text"
						placeholder="Name*"
						oninput="this.className = ''"
						name="name"
					/>
				</p>
				<p>
					<input
						type="text"
						placeholder="Email*"
						oninput="this.className = ''"
						name="email"
					/>
				</p>
				<p>
					<input
						type="text"
						placeholder="Phone*"
						oninput="this.className = ''"
						name="phone"
						required
					/>
				</p>
				<p>
					<input
						type="text"
						placeholder="Linkedin*"
						oninput="this.className = ''"
						name="linkedin"
					/>
				</p>
				<p>
					<input
						type="text"
						placeholder="Github*"
						oninput="this.className = ''"
						name="github"
					/>
				</p>
				<p>
					<input
						type="text"
						placeholder="Skills*(Separate Each Skill with space and comma)"
						oninput="this.className = ''"
						name="skills"
					/>
				</p>
			</div>
			<div class="tab">
				Experience Info:
			</br><b>1:</b></br>
				<p>
					
					<input
						type="text"
						placeholder="Organisation*"
						name="exp1_org"
						oninput="this.className = ''"
					/>
					<input
						type="text"
						placeholder="Position*"
						name="exp1_pos"
						oninput="this.className = ''"
					/>
					<input
						type="text"
						placeholder="Duration*"
						name="exp1_dur"
						oninput="this.className = ''"
					/>
					<input
						type="text"
						placeholder="Description*"
						name="exp1_desc"
						oninput="this.className = ''"
					/>
				</p>
			</br><b>2:</b></br>
				<p>
					<input
						type="text"
						placeholder="Organisation*"
						name="exp2_org"
						oninput="this.className = ''"
					/>
					<input
						type="text"
						placeholder="Position*"
						name="exp2_pos"
						oninput="this.className = ''"
					/>
					<input
						type="text"
						placeholder="Duration*"
						name="exp2_dur"
						oninput="this.className = ''"
					/>
					<input
						type="text"
						placeholder="Description*"
						name="exp2_desc"
						oninput="this.className = ''"
					/>
				</p>
			</div>
			<div class="tab">
				Projects:
			</br><b>1:</b></br>
			
				<p>
					<input 
						type="text" 
						placeholder="Title*"
						name="proj1_title"
						oninput="this.className = ''" 
					 />
				</p>
				<p>
					<input 
						type="text" 
						placeholder="Link*"
						name="proj1_link"
						oninput="this.className = ''" 
					 />
				</p>
				<p>
					<input 
						type="text" 
						placeholder="Description*"
						name="proj1_desc"
						oninput="this.className = ''" 
					 />
				</p>
			</br><b>2:</b></br>
			
				<p>
					<input 
						type="text" 
						placeholder="Title*"
						name="proj2_title"
						oninput="this.className = ''" 
					 />
				</p>
				<p>
					<input 
						type="text" 
						placeholder="Link*"
						name="proj2_link"
						oninput="this.className = ''" 
					 />
				</p>
				<p>
					<input 
						type="text" 
						placeholder="Description*"
						name="proj2_desc"
						oninput="this.className = ''" 
					 />
				</p>
			</div>
			<div class="tab">
				Education Info:
			</br><b>1:</b></br>
				<p>
					<input
						placeholder="College/University*"
						oninput="this.className = ''"
						name="edu1_school"
					/>
				</p>
				<p>
					<input
						placeholder="Year*"
						oninput="this.className = ''"
						name="edu1_year"
					/>
				</p>
				<p>
					<input
						placeholder="Qualification*"
						oninput="this.className = ''"
						name="edu1_qualification"
					/>
				</p>
				<p>
					<input
						placeholder="Description*"
						oninput="this.className = ''"
						name="edu1_desc"
					/>
				</p>
				</br><b>2:</b></br>
				<p>
					<input
						placeholder="College/University*"
						oninput="this.className = ''"
						name="edu2_school"
					/>
				</p>
				<p>
					<input
						placeholder="Year*"
						oninput="this.className = ''"
						name="edu2_year"
					/>
				</p>
				<p>
					<input
						placeholder="Qualification*"
						oninput="this.className = ''"
						name="edu2_qualification"
					/>
				</p>
				<p>
					<input
						placeholder="Description*"
						oninput="this.className = ''"
						name="edu2_desc"
					/>
				</p>
			</div>
			<div class="tab">
				Misc
				<p>
					 <input 
						type="text" 
						name="extra_1" 
						placeholder="Languages*"
						oninput="this.className = ''"
					  />
				</p>
				<p>
					 <input 
						type="text" 
						name="extra_2" 
						placeholder="Hobbies*"
						oninput="this.className = ''"
					  />
				</p>
				<p>
					 <input 
						type="text" 
						name="extra_3" 
						placeholder="Achievement/Activity*"
						oninput="this.className = ''"
					  />
				</p>
				<p>
					 <input 
						type="text" 
						name="extra_4" 
						placeholder="Achievement/Activity*"
						oninput="this.className = ''"
					  />
				</p>
				<p>
					 <input 
						type="text" 
						name="extra_5" 
						placeholder="Achievement/Activity*"
						oninput="this.className = ''"
					  />
				</p>
			</div>
			<div style="overflow: auto;">
				<div style="float: right;">
					<button type="button" id="prevBtn" onclick="nextPrev(-1)">
						Previous
					</button>
					<button type="button" id="nextBtn"  onclick="nextPrev(1)">
						Next
					</button>
				</div>
			</div>
			<!-- Circles which indicates the steps of the form: -->
			<div style="text-align: center; margin-top: 40px;">
				<span class="step"></span>
				<span class="step"></span>
				<span class="step"></span>
				<span class="step"></span>
				<span class="step"></span>
			</div>
		</form>

		<script>

			function  handleSubmit(){
				const frm=document.getElementById("regForm");
				let formObj={};
				for(let i=0;i<frm.length-2;i++){
					formObj[frm[i].attributes["name"].value]=frm[i].value;
				}
				 axios.post(' https://resume-swpril.herokuapp.com/create', formObj)
            	.then(() => axios.get(' https://resume-swpril.herokuapp.com/fetch', { responseType: 'blob' }))
            	.then((res) => {
                const pdfBlob = new Blob([res.data], { type: 'application/pdf' });

				saveAs(pdfBlob, 'Resume.pdf');
				frm.submit();
            });

			}
					let currentTab = 0;
					showTab(currentTab); 

					function showTab(n) {
					let x = document.getElementsByClassName("tab");
					x[n].style.display = "block";
					if (n == 0) {
						document.getElementById("prevBtn").style.display = "none";
					} else {
						document.getElementById("prevBtn").style.display = "inline";
					}
					if (n == (x.length - 1)) {
						const btn=document.getElementById("nextBtn");
						btn.innerHTML = "Download PDF";
						
					} else {
						document.getElementById("nextBtn").innerHTML = "Next";
					}
					fixStepIndicator(n)
					}

					function nextPrev(n) {
					let x = document.getElementsByClassName("tab");
					if (n == 1 && !validateForm()) return false;
					x[currentTab].style.display = "none"
					currentTab = currentTab + n;
				
					if (currentTab >= x.length) {
					
						handleSubmit();
					
						return false;
					}
					
					showTab(currentTab);
					}

					function validateForm() {
					
					let x, y, i, valid = true;
					x = document.getElementsByClassName("tab");
					y = x[currentTab].getElementsByTagName("input");
				
					for (i = 0; i < y.length; i++) {
					
						if (y[i].value == "") {
					
						y[i].className += " invalid";
				
						valid = false;
						}
					}
				
					if (valid) {
						document.getElementsByClassName("step")[currentTab].className += " finish";
					}
					return valid; 
					}

					function fixStepIndicator(n) {
					let i, x = document.getElementsByClassName("step");
					for (i = 0; i < x.length; i++) {
						x[i].className = x[i].className.replace(" active", "");
					}
				
					x[n].className += " active";
					}
		</script>

	</body>
</html>
